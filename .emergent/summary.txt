<analysis>
The AI engineer's work focused on enhancing a combat sports judging tool, starting from an MVP state to implement a suite of advanced features. The trajectory details the sequential completion of 9 out of 10 planned advanced features, with one feature (Distraction-Free Mode) being implemented and subsequently removed per user request. Key accomplishments include fully functional Shadow Judging, robust Offline-First sync, detailed Explainability Cards, Fighter Memory Logs, Discrepancy Flags, Per-Promotion Tuning, Uncertainty Bands, and Accessibility. A comprehensive tie-breaking system was added to the scoring algorithm. The engineer meticulously addressed bugs, particularly frontend navigation issues post-login and data mismatches between frontend and backend. The work concluded mid-implementation of the final feature, Security & Audit, having developed its backend and partially its frontend.
</analysis>

<product_requirements>
The application is a combat sports judging tool featuring an Operator Panel for real-time event logging (KD, SS, TD, SUB, Pass, Reversal with details and control timers) and a Judge Panel for viewing computed scores. The scoring uses a custom algorithm (FightJudge) that calculates subscores (0-10 continuous), composites into a 1-1000 strength score, and maps to the official 10-Point-Must system (10-10, 10-9, 10-8, 10-7) with specific delta thresholds and gate checks. The UI/UX emphasizes a dark theme, readability, responsiveness, and uses Shadcn UI components. Advanced features include Shadow-Judging/Training, Offline-First + Sync, Explainability Cards, Fighter Memory Log, Judge Profile Sign-in, Discrepancy Flags, Per-Promotion Tuning, Distraction-Free Mode (later removed), Uncertainty Bands, Accessibility, and Security & Audit (cryptographic signatures, WORM logs).
</product_requirements>

<key_technical_concepts>
- **Full-Stack Application**: React (frontend), FastAPI (backend), MongoDB (database).
- **Real-time Database**: Firebase Firestore for event logging.
- **Custom Scoring Algorithm**: Detailed 10-Point-Must system with gate checks and tie-breakers.
- **Offline-First**: IndexedDB for local storage and synchronization.
- **Shadcn UI**: Component library for frontend.
- **Asynchronous Data Handling**: Efficient API calls and real-time updates.
</key_technical_concepts>

<code_architecture>


-   **/app/backend/server.py**: Main FastAPI application.
    -   **Importance**: Central API for all backend logic, data persistence, and scoring.
    -   **Changes**: Substantially modified to include APIs and models for Shadow Judging, Fighter Memory, Discrepancy Flags, Tuning Profiles, Uncertainty Bands, and Security & Audit. The  function was enhanced with detailed tie-breaking logic. Uncertainty calculation and audit logging were integrated into the  endpoint.
-   **/app/frontend/src/App.js**: Main React component, handles routing.
    -   **Importance**: Orchestrates application views and integrations.
    -   **Changes**: Routes added for , , , . The app was wrapped with .
-   **/app/frontend/src/index.css**: Global CSS styles.
    -   **Importance**: Defines application-wide styling, including accessibility themes.
    -   **Changes**: Added CSS for large-type and high-contrast accessibility modes.
-   **/app/frontend/src/firebase.js**: Firebase initialization and Firestore instance.
    -   **Importance**: Connects to Firestore.
    -   **Changes**: Updated to use  and .
-   **/app/frontend/src/components/EventSetup.jsx**: Component for initial bout/event configuration.
    -   **Importance**: Entry point for setting up events and navigating to various features.
    -   **Changes**: Added navigation buttons for Shadow Judging Training, Review Dashboard, Tuning Profiles, and Accessibility Settings.
-   **/app/frontend/src/components/OperatorPanel.jsx**: Panel for real-time event logging.
    -   **Importance**: Core UI for data entry.
    -   **Changes**: Integrated the new  for offline-first capabilities, replacing previous  logic. Added error handling for event logging and a loading state.
-   **/app/frontend/src/components/JudgePanel.jsx**: View-only scoring panel.
    -   **Importance**: Displays computed scores and explanations.
    -   **Changes**: Integrated . Implemented and later removed Distraction-Free Mode functionality. Added visual indicators for Uncertainty Bands.
-   **/app/frontend/src/components/JudgeLogin.jsx**: Judge authentication/profile entry point.
    -   **Importance**: Handles judge login.
    -   **Changes**: Simplified login logic, removing direct Firebase calls and using  for judge profile persistence.  used for navigation. Fixed  access.
-   **/app/frontend/src/components/ShadowJudgingMode.jsx**: Training/calibration mode for judges.
    -   **Importance**: Allows judges to practice scoring against historical data.
    -   **Changes**: Updated to use backend APIs for fetching rounds, submitting scores, and displaying judge stats/leaderboards. Corrected environment variable access.
-   **/app/frontend/src/utils/advancedFeatures.js**: Utility for advanced feature integration.
    -   **Importance**: Contains helper functions for complex logic.
    -   **Changes**:  function enhanced for more detailed, event-specific explanations. The  was effectively superseded by .
-   **/app/frontend/src/utils/offlineDB.js**: New utility for IndexedDB operations.
    -   **Importance**: Manages local data storage for offline support.
    -   **Changes**: Created to handle IndexedDB interactions.
-   **/app/frontend/src/utils/syncManager.js**: New utility for offline synchronization.
    -   **Importance**: Manages syncing local data with Firebase and the backend.
    -   **Changes**: Created to manage queueing, syncing, and conflict resolution. Fixed a critical bug where it wrote to a nested Firestore path instead of the flat  collection expected by .
-   **/app/frontend/src/components/ExplainabilityCard.jsx**: Component to explain judging decisions.
    -   **Importance**: Provides transparency for score cards.
    -   **Changes**: No explicit changes to this UI file in the trajectory, but it now consumes more detailed data from the enhanced  function.
-   **/app/frontend/src/components/FighterMemoryLog.jsx**: Tracks fighter tendencies and stats.
    -   **Importance**: Provides historical analysis.
    -   **Changes**: Completely rewritten to integrate with the new backend fighter stats APIs.
-   **/app/frontend/src/components/ReviewDashboard.jsx**: Displays flagged scoring decisions.
    -   **Importance**: Facilitates review of controversial rounds.
    -   **Changes**: New component created.
-   **/app/frontend/src/components/TuningProfileManager.jsx**: Manages promotion-specific scoring parameters.
    -   **Importance**: Allows customization of scoring rules.
    -   **Changes**: New component created. Implemented logic to hide metric weights/thresholds for non-owners.
-   **/app/frontend/src/components/AccessibilitySettings.jsx**: Panel for accessibility options.
    -   **Importance**: Provides options for large-type, high-contrast, etc.
    -   **Changes**: New component created.
-   **/app/frontend/src/contexts/AccessibilityContext.jsx**: React context for accessibility.
    -   **Importance**: Provides global accessibility state.
    -   **Changes**: Confirmed to exist and used to wrap .
-   **/app/frontend/src/components/AuditLogViewer.jsx**: Displays audit trails.
    -   **Importance**: Provides a record of significant actions for security.
    -   **Changes**: New component created.
</code_architecture>

<pending_tasks>
-   Complete the frontend integration for **Feature #10: Security & Audit**, specifically adding the route for  in  and a navigation button in .
-   Further implementation of Judge Profile Sign-in beyond basic login, such as profile management.
</pending_tasks>

<current_work>
The AI engineer was immediately working on implementing **Feature #10: Security & Audit**. On the backend, models (, ) and cryptographic functions were added to , and audit logging was integrated into the  endpoint to ensure WORM (Write Once Read Many) compliance and cryptographic signatures for significant events. On the frontend, the  component was successfully created. The very last action in the trajectory was the preparation to add the route for  in  and a corresponding navigation button in , signifying the final steps of this feature's integration into the UI.
</current_work>

<optional_next_step>
Add the route for  in  and a navigation button in .
</optional_next_step>
